<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Tạo CV mới - CVBuilder</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        body {
            background: #f4f6f9;
            font-family: 'Segoe UI', sans-serif;
            padding: 40px;
        }
        .form-container {
            max-width: 800px;
            margin: auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }
        .form-container h2 {
            text-align: center;
            margin-bottom: 25px;
        }
        .form-container input,
        .form-container textarea {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            font-size: 15px;
            border: 1px solid #ccc;
            border-radius: 8px;
        }
        .form-container button {
            padding: 12px 20px;
            background-color: #4e73df;
            color: white;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            margin: auto;
        }
    </style>
</head>
<body>

<div class="form-container">
    <h2>Tạo CV mới</h2>
    <form id="cv-form">
        <input type="text" name="fullName" placeholder="Họ tên" required />
        <input type="email" name="email" placeholder="Email" required />
        <input type="text" name="jobTitle" placeholder="Vị trí ứng tuyển" />
        <input type="text" name="phone" placeholder="Số điện thoại" />
        <input type="text" name="address" placeholder="Địa chỉ" />
        <input type="date" name="dateOfBirth" placeholder="Ngày sinh" />
        <textarea name="careerObjective" placeholder="Mục tiêu nghề nghiệp"></textarea>
        <textarea name="profileSummary" placeholder="Tóm tắt hồ sơ"></textarea>
        <textarea name="experience" placeholder="Kinh nghiệm"></textarea>
        <textarea name="education" placeholder="Học vấn"></textarea>
        <textarea name="skills" placeholder="Kỹ năng"></textarea>
        <textarea name="certifications" placeholder="Chứng chỉ"></textarea>
        <textarea name="projects" placeholder="Dự án"></textarea>
        <textarea name="languages" placeholder="Ngôn ngữ"></textarea>
        <input type="text" name="linkedIn" placeholder="LinkedIn URL" />
        <input type="text" name="github" placeholder="Github URL" />
        <input type="text" name="websiteUrl" placeholder="Website cá nhân" />
        <button type="submit">Lưu CV</button>
    </form>
</div>

<script>
    document.getElementById('cv-form').addEventListener('submit', async function(e) {
        e.preventDefault();

        const formData = new FormData(this);
        const json = Object.fromEntries(formData.entries());

        const token = localStorage.getItem('token');

        const response = await fetch('/api/cv', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Accept': 'application/json',
                'Authorization': 'Bearer ' + token
            },
            body: JSON.stringify(json)
        });

        if (response.ok) {
            alert('CV đã được tạo thành công!');
            window.location.href = '/my-cvs';
        } else {
            const error = await response.text();
            alert('Lỗi tạo CV: ' + error);
        }
    });
</script>

</body>
</html>
